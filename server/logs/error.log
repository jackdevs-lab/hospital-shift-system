{"level":"error","message":"Migration failed: relation \"departments\" does not exist","name":"SequelizeDatabaseError","original":{"code":"42P01","file":"namespace.c","length":109,"line":"433","name":"error","routine":"RangeVarGetRelidExtended","severity":"ERROR","sql":"CREATE TABLE IF NOT EXISTS \"users\" (\"id\"  SERIAL , \"email\" VARCHAR(255) NOT NULL UNIQUE, \"password_hash\" VARCHAR(255) NOT NULL, \"full_name\" VARCHAR(255) NOT NULL, \"role\" \"public\".\"enum_users_role\" NOT NULL DEFAULT 'doctor', \"department_id\" INTEGER REFERENCES \"departments\" (\"id\"), \"is_active\" BOOLEAN DEFAULT true, \"last_login_at\" TIMESTAMP WITH TIME ZONE, \"phone_number\" VARCHAR(20), \"employee_id\" VARCHAR(50) UNIQUE, \"profile_image_url\" VARCHAR(500), \"push_notification_token\" VARCHAR(500), \"email_notifications_enabled\" BOOLEAN DEFAULT true, \"push_notifications_enabled\" BOOLEAN DEFAULT true, \"created_at\" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP, \"updated_at\" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (\"id\"));"},"parameters":{},"parent":{"code":"42P01","file":"namespace.c","length":109,"line":"433","name":"error","routine":"RangeVarGetRelidExtended","severity":"ERROR","sql":"CREATE TABLE IF NOT EXISTS \"users\" (\"id\"  SERIAL , \"email\" VARCHAR(255) NOT NULL UNIQUE, \"password_hash\" VARCHAR(255) NOT NULL, \"full_name\" VARCHAR(255) NOT NULL, \"role\" \"public\".\"enum_users_role\" NOT NULL DEFAULT 'doctor', \"department_id\" INTEGER REFERENCES \"departments\" (\"id\"), \"is_active\" BOOLEAN DEFAULT true, \"last_login_at\" TIMESTAMP WITH TIME ZONE, \"phone_number\" VARCHAR(20), \"employee_id\" VARCHAR(50) UNIQUE, \"profile_image_url\" VARCHAR(500), \"push_notification_token\" VARCHAR(500), \"email_notifications_enabled\" BOOLEAN DEFAULT true, \"push_notifications_enabled\" BOOLEAN DEFAULT true, \"created_at\" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP, \"updated_at\" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (\"id\"));"},"sql":"CREATE TABLE IF NOT EXISTS \"users\" (\"id\"  SERIAL , \"email\" VARCHAR(255) NOT NULL UNIQUE, \"password_hash\" VARCHAR(255) NOT NULL, \"full_name\" VARCHAR(255) NOT NULL, \"role\" \"public\".\"enum_users_role\" NOT NULL DEFAULT 'doctor', \"department_id\" INTEGER REFERENCES \"departments\" (\"id\"), \"is_active\" BOOLEAN DEFAULT true, \"last_login_at\" TIMESTAMP WITH TIME ZONE, \"phone_number\" VARCHAR(20), \"employee_id\" VARCHAR(50) UNIQUE, \"profile_image_url\" VARCHAR(500), \"push_notification_token\" VARCHAR(500), \"email_notifications_enabled\" BOOLEAN DEFAULT true, \"push_notifications_enabled\" BOOLEAN DEFAULT true, \"created_at\" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP, \"updated_at\" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (\"id\"));","stack":"Error\n    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)\n    at /app/node_modules/sequelize/lib/sequelize.js:315:28\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async PostgresQueryInterface.createTable (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:98:12)\n    at async Object.up (/app/database/migrations/001_create_users.js:3:1)\n    at async migrate (/app/scripts/migrate.js:16:1)","timestamp":"2026-01-02 02:36:19:3619"}
{"level":"error","message":"Migration failed: relation \"departments\" does not exist","name":"SequelizeDatabaseError","original":{"code":"42P01","file":"namespace.c","length":109,"line":"433","name":"error","routine":"RangeVarGetRelidExtended","severity":"ERROR","sql":"CREATE TABLE IF NOT EXISTS \"shifts\" (\"id\"  SERIAL , \"date\" DATE NOT NULL, \"start_time\" TIME NOT NULL, \"end_time\" TIME NOT NULL, \"shift_type\" \"public\".\"enum_shifts_shift_type\" NOT NULL DEFAULT 'day', \"department_id\" INTEGER NOT NULL REFERENCES \"departments\" (\"id\"), \"status\" \"public\".\"enum_shifts_status\" NOT NULL DEFAULT 'planned', \"actual_start_time\" TIMESTAMP WITH TIME ZONE, \"actual_end_time\" TIMESTAMP WITH TIME ZONE, \"late_minutes\" INTEGER DEFAULT 0, \"early_exit_minutes\" INTEGER DEFAULT 0, \"notes\" TEXT, \"created_by\" INTEGER NOT NULL REFERENCES \"users\" (\"id\"), \"updated_by\" INTEGER REFERENCES \"users\" (\"id\"), \"created_at\" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP, \"updated_at\" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (\"id\"));"},"parameters":{},"parent":{"code":"42P01","file":"namespace.c","length":109,"line":"433","name":"error","routine":"RangeVarGetRelidExtended","severity":"ERROR","sql":"CREATE TABLE IF NOT EXISTS \"shifts\" (\"id\"  SERIAL , \"date\" DATE NOT NULL, \"start_time\" TIME NOT NULL, \"end_time\" TIME NOT NULL, \"shift_type\" \"public\".\"enum_shifts_shift_type\" NOT NULL DEFAULT 'day', \"department_id\" INTEGER NOT NULL REFERENCES \"departments\" (\"id\"), \"status\" \"public\".\"enum_shifts_status\" NOT NULL DEFAULT 'planned', \"actual_start_time\" TIMESTAMP WITH TIME ZONE, \"actual_end_time\" TIMESTAMP WITH TIME ZONE, \"late_minutes\" INTEGER DEFAULT 0, \"early_exit_minutes\" INTEGER DEFAULT 0, \"notes\" TEXT, \"created_by\" INTEGER NOT NULL REFERENCES \"users\" (\"id\"), \"updated_by\" INTEGER REFERENCES \"users\" (\"id\"), \"created_at\" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP, \"updated_at\" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (\"id\"));"},"sql":"CREATE TABLE IF NOT EXISTS \"shifts\" (\"id\"  SERIAL , \"date\" DATE NOT NULL, \"start_time\" TIME NOT NULL, \"end_time\" TIME NOT NULL, \"shift_type\" \"public\".\"enum_shifts_shift_type\" NOT NULL DEFAULT 'day', \"department_id\" INTEGER NOT NULL REFERENCES \"departments\" (\"id\"), \"status\" \"public\".\"enum_shifts_status\" NOT NULL DEFAULT 'planned', \"actual_start_time\" TIMESTAMP WITH TIME ZONE, \"actual_end_time\" TIMESTAMP WITH TIME ZONE, \"late_minutes\" INTEGER DEFAULT 0, \"early_exit_minutes\" INTEGER DEFAULT 0, \"notes\" TEXT, \"created_by\" INTEGER NOT NULL REFERENCES \"users\" (\"id\"), \"updated_by\" INTEGER REFERENCES \"users\" (\"id\"), \"created_at\" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP, \"updated_at\" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (\"id\"));","stack":"Error\n    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)\n    at /app/node_modules/sequelize/lib/sequelize.js:315:28\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async PostgresQueryInterface.createTable (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:98:12)\n    at async Object.up (/app/database/migrations/002_create_shifts.js:3:5)\n    at async migrate (/app/scripts/migrate.js:16:1)","timestamp":"2026-01-02 02:41:05:415"}
{"level":"error","message":"Migration failed: relation \"users_email\" already exists","name":"SequelizeDatabaseError","original":{"code":"42P07","file":"index.c","length":93,"line":"873","name":"error","routine":"index_create","severity":"ERROR","sql":"CREATE UNIQUE INDEX \"users_email\" ON \"users\" (\"email\")"},"parameters":{},"parent":{"code":"42P07","file":"index.c","length":93,"line":"873","name":"error","routine":"index_create","severity":"ERROR","sql":"CREATE UNIQUE INDEX \"users_email\" ON \"users\" (\"email\")"},"sql":"CREATE UNIQUE INDEX \"users_email\" ON \"users\" (\"email\")","stack":"Error\n    at Query.run (/app/node_modules/sequelize/lib/dialects/postgres/query.js:50:25)\n    at /app/node_modules/sequelize/lib/sequelize.js:315:28\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async PostgresQueryInterface.addIndex (/app/node_modules/sequelize/lib/dialects/abstract/query-interface.js:250:12)\n    at async Object.up (/app/database/migrations/001_create_users.js:73:5)\n    at async migrate (/app/scripts/migrate.js:16:1)","timestamp":"2026-01-02 02:46:45:4645"}
